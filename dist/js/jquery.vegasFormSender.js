(function(v){v.fn.vegasFormSender=function(h){h=v.extend({error:function(){},success:function(){},beforeSend:function(){},validate:function(){}},arguments[0]||{});var e=this;e.each(function(){var i=v(this),o=h.action||i.attr("action")||location.href,c=h.method||i.attr("method")||"get",f=h.fields?h.fields:false,l=h.redirectSuccess||i.data("redirect-success")||false,e=h.redirectError||i.data("redirect-error")||false;if(f&&typeof f=="function"){f=h.fields()}var u=true;i.on("submit",function(){var e=new FormData(this),r=v(this).find("[data-validate]");if(r.length){var t=d(r);h.validate.call(this,i,t);if(t.length)u=false}if(u){if(f){for(var a in f){if(typeof f[a]==="object"){for(var n in f[a]){var s=Object.keys(f[a][n]).map(function(e){return f[a][n][e]});e.append(a,s)}}else{e.append(a,f[a])}}}v.ajax({url:o,method:c,data:e,cache:false,contentType:false,processData:false,beforeSend:function(){h.beforeSend.call(this,i)},success:function(e){var r=e;if(l){window.location.href=l}else{h.success.call(this,r,i)}},error:function(e,r){var t=JSON.parse(e.responseText);var a;if(t.errors){a=t.errors[Object.keys(t.errors)[0]][0]}else{a=t.message||t.msg}h.error.call(this,a,i)}})}return false});function d(e){var r=[];e.each(function(){var e=v(this);if(e.val()===""){r.push(e)}});return r}});return this}})(jQuery);